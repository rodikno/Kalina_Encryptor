<?php
// $teta_1 = 0x8000000000000000;
// $hi_bit_1 = ($teta_1 & 0x8000000000000000)?1:0;
// echo $teta_1,'<br>';
// echo hexdec($teta_1),'<br>';
// echo $hi_bit_1;
// exit;

echo <<< TXT
<html>
<head>
<meta charset="utf8">
<style>
body{font-family:"Courier New", Courier, monospace;}
</style>
</head>
<body>
<div style="height:10000px;">
TXT;
require_once "kalina_funcs.php";

$K = array(
    array(0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07),
    array(0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F)
);

$Text =  array(
    array(0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17),
    array(0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F)
);

$G = encrypt128($Text,$K);
show($G,"enc");
$D = decrypt128($G,$K);
show($D,"dec");

echo "<hr>Decryption. <br>";  

$K = array(
    array(0x0F, 0x0E, 0x0D, 0x0C, 0x0B, 0x0A, 0x09, 0x08),
    array(0x07, 0x06, 0x05, 0x04, 0x03, 0x02, 0x01, 0x00)
);

$CT = array(
    array(0x1F, 0x1E, 0x1D, 0x1C, 0x1B, 0x1A, 0x19, 0x18),
    array(0x17, 0x16, 0x15, 0x14, 0x13, 0x12, 0x11, 0x10)
);

$Gg = decrypt128($CT,$K);
show($Gg,"dec");
$E = encrypt128($Gg,$K);
show($E,"enc");
    
echo "</div></body></html>";